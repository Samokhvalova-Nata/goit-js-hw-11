{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,uCAOA,MAAMC,EAAO,CACTC,OAAQC,SAASC,cAAc,gBAC/BC,cAAeF,SAASC,cAAc,cACtCE,UAAWH,SAASC,cAAc,aAEtC,IAAIG,EAAU,KACd,MAAMC,EAAa,IAAI,EAAAT,EAAAU,YA6EvB,SAASC,IACLT,EAAKI,cAAcM,UAAUC,IAAI,Y,CA5ErCX,EAAKC,OAAOW,iBAAiB,UAI7BC,eAAsCC,GAOlC,GANAA,EAAIC,iBAyDR,WACIf,EAAKK,UAAUW,UAAY,E,CAzD3BC,GAEAV,EAAWW,MAAQJ,EAAIK,OAAOC,SAASC,YAAYC,MAAMC,OACzDhB,EAAWiB,YAEc,KAArBjB,EAAWW,MAGX,OAFAO,EAAAC,OAAOC,QAAQ,+CACflB,IAIJ,IACI,MAAMmB,KAAEA,SAAerB,EAAWsB,cAClC,GAAyB,IAArBD,EAAKE,KAAKC,OAIV,OAHAN,EAAAC,OAAOC,QAAQ,4EACflB,SACAT,EAAKC,OAAO+B,QAIhBP,EAAAC,OAAOO,QAAQ,oBAAoBL,EAAKM,qBACxClC,EAAKK,UAAUW,WAAY,EAAAmB,EAAAC,SAAmBR,EAAKE,MAqDvD9B,EAAKI,cAAcM,UAAU2B,OAAO,aAlDhC/B,EAAU,IAAIgC,EAAAC,GAAJ,CAAmB,cAAe,CACpCC,aAAc,IACdC,YAAY,IAGhBb,EAAKM,WAAa3B,EAAWmC,OAC7BjC,G,CAEN,MAAOkC,GACLC,QAAQC,IAAIF,E,KAtCpB3C,EAAKI,cAAcQ,iBAAiB,SA0CpCC,eAAsCC,GAClCP,EAAWuC,gBAEX,IACI,MAAMlB,KAAEA,SAAerB,EAAWsB,cAE9BkB,KAAKC,KAAKpB,EAAKM,UAAY3B,EAAWmC,SAAWnC,EAAW0C,OAC5DxC,IACAgB,EAAAC,OAAOwB,KAAK,+DAGhBlD,EAAKK,UAAU8C,mBAAmB,aAAa,EAAAhB,EAAAC,SAAmBR,EAAKE,OACvExB,EAAQ8C,UAWhB,WACI,MAAQC,OAAQC,GAAepD,SAASC,cAAc,YAAYoD,kBAAkBC,wBAEpFC,OAAOC,SAAS,CACZC,IAAkB,EAAbL,EACLM,SAAU,U,CAfVC,E,CACF,MAAOlB,GACLC,QAAQC,IAAIF,E","sources":["src/js/loadMoreBtn.js"],"sourcesContent":["import { PixabayAPI } from './pixabay-api';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport createGalleryCards from '../templates/gallery-card.hbs';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst refs = {\n    formEl: document.querySelector('.search-form'),\n    loadMoreBtnEl: document.querySelector('.load-more'),\n    galleryEl: document.querySelector('.gallery'),\n}\nlet gallery = null;\nconst pixabayAPI = new PixabayAPI();\n\nrefs.formEl.addEventListener('submit', handleSearchFormSubmit);\nrefs.loadMoreBtnEl.addEventListener('click', handleLoadMoreBtnClick);\n\n\nasync function handleSearchFormSubmit(evt) {\n    evt.preventDefault();\n    clearMarkup();\n\n    pixabayAPI.query = evt.target.elements.searchQuery.value.trim();\n    pixabayAPI.resetPage();\n\n    if (pixabayAPI.query === '') {\n        Notify.failure(\"Sorry, enter something in search line.\");\n        hideLoadMoreBtn();\n        return;\n    };\n\n    try {\n        const { data } = await pixabayAPI.fetchPhotos();\n        if (data.hits.length === 0) {\n            Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n            hideLoadMoreBtn();\n            refs.formEl.reset();\n            return;\n        }\n\n        Notify.success(`Hooray! We found ${data.totalHits} images.`);\n        refs.galleryEl.innerHTML = createGalleryCards(data.hits);\n        showLoadMoreBtn();\n\n        gallery = new SimpleLightbox('.gallery  a', {\n                captionDelay: 250,\n                scrollZoom: false,\n        });\n\n        if (data.totalHits <= pixabayAPI.count) {\n            hideLoadMoreBtn();\n        };\n    } catch (err) {\n        console.log(err);\n    }\n};\n\nasync function handleLoadMoreBtnClick(evt) {\n    pixabayAPI.incrementPage();\n\n    try {\n        const { data } = await pixabayAPI.fetchPhotos();\n        \n        if (Math.ceil(data.totalHits / pixabayAPI.count) === pixabayAPI.page) {\n            hideLoadMoreBtn();\n            Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        }\n\n        refs.galleryEl.insertAdjacentHTML('beforeend', createGalleryCards(data.hits));\n        gallery.refresh();\n        smoothScroll();\n    } catch (err) {\n        console.log(err);\n    }\n};\n\nfunction clearMarkup() {\n    refs.galleryEl.innerHTML = '';\n};\n\nfunction smoothScroll() {\n    const { height: cardHeight } = document.querySelector(\".gallery\").firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n    });\n};\n\nfunction hideLoadMoreBtn() {\n    refs.loadMoreBtnEl.classList.add('is-hidden');\n};\n\nfunction showLoadMoreBtn() {\n    refs.loadMoreBtnEl.classList.remove('is-hidden');\n};\n"],"names":["$6fOXY","parcelRequire","$edbe7487e4026872$var$refs","formEl","document","querySelector","loadMoreBtnEl","galleryEl","$edbe7487e4026872$var$gallery","$edbe7487e4026872$var$pixabayAPI","PixabayAPI","$edbe7487e4026872$var$hideLoadMoreBtn","classList","add","addEventListener","async","evt","preventDefault","innerHTML","$edbe7487e4026872$var$clearMarkup","query","target","elements","searchQuery","value","trim","resetPage","$iQIUW","Notify","failure","data","fetchPhotos","hits","length","reset","success","totalHits","$cdIRi","default","remove","$parcel$interopDefault","$fZKcF","captionDelay","scrollZoom","count","err","console","log","incrementPage","Math","ceil","page","info","insertAdjacentHTML","refresh","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$edbe7487e4026872$var$smoothScroll"],"version":3,"file":"loadmore button.2e6a3075.js.map"}